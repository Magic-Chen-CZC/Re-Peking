<view class="share-edit-container">
  <!-- å¯¼èˆªæ  -->
  <view class="navbar">
    <view class="navbar-back" bindtap="cancel">
      <text>â†</text>
    </view>
    <view class="navbar-title">åˆ†äº«åˆ°ç¤¾åŒº</view>
    <view class="navbar-placeholder"></view>
  </view>

  <!-- åŠ è½½çŠ¶æ€ -->
  <view wx:if="{{isLoading}}" class="loading-container">
    <view class="loading-spinner"></view>
    <text class="loading-text">åŠ è½½ä¸­...</text>
  </view>

  <!-- å†…å®¹åŒºåŸŸ -->
  <scroll-view wx:else scroll-y class="content-scroll">
    <!-- æ—…ç¨‹å¿«ç…§ -->
    <view class="section trip-snapshot">
      <view class="section-title">ğŸ“ æ—…ç¨‹å¿«ç…§</view>
      <view class="trip-info">
        <text class="trip-status">{{tripDetail.status || 'PLANNING'}}</text>
        <text class="trip-stops-count">{{tripDetail.stops.length}} ç«™</text>
      </view>
      
      <!-- Stops åˆ—è¡¨ -->
      <view class="stops-list">
        <block wx:for="{{tripDetail.stops}}" wx:key="seq">
          <view class="stop-item">
            <view class="stop-header">
              <text class="stop-seq">{{item.seq}}</text>
              <text class="stop-name">{{item.name}}</text>
              <text class="stop-status">{{item.status || 'UPCOMING'}}</text>
            </view>
            
            <!-- ç”¨æˆ·è®°å½• -->
            <view wx:if="{{item.user_logs && item.user_logs.length > 0}}" class="stop-logs">
              <text class="logs-label">ğŸ’­ æˆ‘çš„è®°å½•ï¼š</text>
              <block wx:for="{{item.user_logs}}" wx:key="index" wx:for-item="log">
                <text class="log-item">Â· {{log}}</text>
              </block>
            </view>
            
            <!-- AI æ‘˜è¦ -->
            <view wx:if="{{item.ai_summary}}" class="stop-summary">
              <text class="summary-label">ğŸ¤– AI æ‘˜è¦ï¼š</text>
              <text class="summary-text">{{item.ai_summary}}</text>
            </view>
          </view>
        </block>
      </view>
    </view>

    <!-- åˆ†äº«æ ‡é¢˜ -->
    <view class="section form-section">
      <view class="section-title">âœï¸ æ ‡é¢˜ <text class="required">*</text></view>
      <input 
        class="input-field" 
        placeholder="ç»™ä½ çš„æ—…ç¨‹èµ·ä¸ªæ ‡é¢˜..." 
        value="{{title}}"
        bindinput="onTitleInput"
        maxlength="100"
      />
      <text class="char-count">{{title.length}}/100</text>
    </view>

    <!-- æ„Ÿæƒ³/åæ€ -->
    <view class="section form-section">
      <view class="section-title">ğŸ’­ æ„Ÿæƒ³ï¼ˆå¯é€‰ï¼‰</view>
      <textarea 
        class="textarea-field" 
        placeholder="åˆ†äº«ä½ çš„æ—…è¡Œæ„Ÿå—ã€æ”¶è·ã€å»ºè®®..."
        value="{{reflection}}"
        bindinput="onReflectionInput"
        maxlength="500"
        auto-height
      />
      <text class="char-count">{{reflection.length}}/500</text>
    </view>

    <!-- å°é¢å›¾ç‰‡ -->
    <view class="section form-section">
      <view class="section-title">ğŸ–¼ï¸ å°é¢å›¾ç‰‡ï¼ˆå¯é€‰ï¼‰</view>
      <view class="cover-picker" bindtap="chooseImage">
        <block wx:if="{{coverLocalPath}}">
          <image src="{{coverLocalPath}}" mode="aspectFill" class="cover-preview"></image>
          <view class="cover-overlay">
            <text>ç‚¹å‡»é‡æ–°é€‰æ‹©</text>
          </view>
        </block>
        <block wx:else>
          <view class="cover-placeholder">
            <text class="placeholder-icon">ğŸ“·</text>
            <text class="placeholder-text">ç‚¹å‡»é€‰æ‹©å›¾ç‰‡</text>
          </view>
        </block>
      </view>
      <text class="cover-hint">æœªé€‰æ‹©å›¾ç‰‡æ—¶ï¼Œå°†ä½¿ç”¨ç¬¬ä¸€ç«™çš„é»˜è®¤å›¾ç‰‡</text>
    </view>

    <!-- åº•éƒ¨é—´è· -->
    <view class="bottom-spacer"></view>
  </scroll-view>

  <!-- åº•éƒ¨æŒ‰é’® -->
  <view class="bottom-actions">
    <view class="btn-cancel" bindtap="cancel">å–æ¶ˆ</view>
    <view class="btn-publish {{isPublishing ? 'disabled' : ''}}" bindtap="publish">
      {{isPublishing ? 'å‘å¸ƒä¸­...' : 'å‘å¸ƒåˆ°ç¤¾åŒº'}}
    </view>
  </view>
</view>
