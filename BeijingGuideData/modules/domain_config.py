"""
ä¸šåŠ¡é¢†åŸŸé…ç½®æ¨¡å—

é›†ä¸­ç®¡ç†æ‰€æœ‰ä¸šåŠ¡ç±»å‹çš„é…ç½®ï¼ŒåŒ…æ‹¬ï¼š
- æ•°æ®æ¨¡å‹ (Schema)
- æç¤ºè¯ (Prompt)
- åˆ†å—ç­–ç•¥ (Chunking Type)
- ä¸šåŠ¡æè¿°

ä½¿ç”¨æ–¹å¼ï¼š
    from modules.domain_config import DOMAIN_CONFIG, get_domain_config
    
    # è·å–ä¼ è¯´æ•…äº‹é…ç½®
    legend_config = get_domain_config("legend")
    schema = legend_config["schema"]
    prompt = legend_config["prompt"]
"""

from typing import Dict, Any, Optional, Type
from pydantic import BaseModel

from modules.schemas import StoryClip, ArchitectureDoc, XHSNote


# ============================================================================
# ä¸šåŠ¡é¢†åŸŸé…ç½®å­—å…¸
# ============================================================================

DOMAIN_CONFIG: Dict[str, Dict[str, Any]] = {
    # ========== å°çº¢ä¹¦ç¬”è®° ==========
    "xhs": {
        "description": "å°çº¢ä¹¦ç¬”è®°",
        "schema": XHSNote,
        
        # åˆ‡åˆ†é…ç½®ï¼ˆå°çº¢ä¹¦ç¬”è®°é€šå¸¸æ˜¯çŸ­æ–‡æœ¬ï¼Œä¸éœ€è¦åˆ†å—ï¼‰
        "chunking": {
            "mode": "none",      # ä¸åˆ†å—ï¼ˆä¿ç•™ä»¥ä¾¿åç»­æ‰©å±•å…¶ä»–æ¨¡å¼ï¼‰
            "chunk_size": 0,     # ä¸åˆ†å—æ—¶æ­¤å‚æ•°æ— æ•ˆ
            "overlap": 0,        # ä¸åˆ†å—æ—¶æ­¤å‚æ•°æ— æ•ˆ
            "min_length": 50,    # æœ€å°æ–‡æœ¬é•¿åº¦ï¼ˆä½äºæ­¤å€¼ç›´æ¥ä¸¢å¼ƒï¼‰
        },
        
        "prompt": """ä½ æ˜¯åŒ—äº¬èµ„æ·±å¯¼æ¸¸ã€‚è¯·åˆ†æè¿™ç¯‡å°çº¢ä¹¦ç¬”è®°ï¼Œæå–ä»¥ä¸‹ä¿¡æ¯ï¼š

âš ï¸ é‡è¦æå–è§„åˆ™ï¼š
- **å¿…é¡»åŒ…å«æ˜ç¡®çš„åœ°ç‚¹**ï¼šå¦‚æœç¬”è®°ä¸­æ²¡æœ‰æåˆ°å…·ä½“çš„åŒ—äº¬åœ°ç‚¹ï¼ˆå¦‚"æ•…å®«"ã€"å—é”£é¼“å··"ï¼‰ï¼Œè¯·ç›´æ¥è·³è¿‡ï¼Œä¸è¦æå–ã€‚
- **ä¸è¦ç¼–é€ ä¿¡æ¯**ï¼šåªæå–ç¬”è®°ä¸­æ˜ç¡®æåˆ°çš„å†…å®¹ï¼Œä¸è¦æ ¹æ®æ¨æµ‹å¡«å……å­—æ®µã€‚

æå–å­—æ®µï¼š
1. **åœ°ç‚¹ (location)**: ç¬”è®°æåˆ°çš„ä¸»è¦åœ°ç‚¹åç§°ï¼ˆå¿…å¡«ï¼Œå¦‚æ— åˆ™è·³è¿‡ï¼‰
2. **åˆ†ç±» (category)**: åœ°ç‚¹ç±»å‹ï¼Œä»ä»¥ä¸‹é€‰é¡¹ä¸­é€‰æ‹©ï¼š
   - æ™¯ç‚¹ï¼šå†å²å¤è¿¹ã€å…¬å›­ã€è§‚æ™¯å°ç­‰
   - ç¾é£Ÿï¼šé¤å…ã€å°åƒã€ç‰¹è‰²é£Ÿå“
   - è´­ç‰©ï¼šå•†åœºã€å¸‚é›†ã€ç‰¹è‰²åº—é“º
   - ä½å®¿ï¼šé…’åº—ã€æ°‘å®¿ã€å®¢æ ˆ
   - äº¤é€šï¼šåœ°é“ã€å…¬äº¤ã€åœè½¦ç­‰
   - å…¶ä»–ï¼šä¸å±äºä»¥ä¸Šåˆ†ç±»çš„å†…å®¹
3. **æ‘˜è¦ (summary)**: ç”¨1-2å¥è¯æ¦‚æ‹¬ç¬”è®°å†…å®¹å’Œäº®ç‚¹
4. **è¯„åˆ† (rating)**: æ ¹æ®å†…å®¹è´¨é‡å’Œå®ç”¨æ€§æ‰“åˆ†(1-5åˆ†)
5. **æœ‰æ•ˆæ€§ (valid)**: åˆ¤æ–­è¿™ç¯‡ç¬”è®°æ˜¯å¦å€¼å¾—æ¨èç»™æ¸¸å®¢
   - True: æœ‰å®é™…åœ°ç‚¹ä¿¡æ¯ã€æœ‰ç”¨çš„å»ºè®®ã€é«˜è´¨é‡å†…å®¹
   - False: å¹¿å‘Šã€æ— å…³å†…å®¹ã€ä¿¡æ¯ä¸æ˜ç¡®
""",
    },
    
    # ========== èƒ¡åŒä¼ è¯´æ•…äº‹ ==========
 "legend": {
        "description": "èƒ¡åŒå¯¼è§ˆç´ æåº“",
        "schema": StoryClip,
        
        "chunking": {
            "mode": "sentence",
            "chunk_size": 1000, 
            "overlap": 200,      
            "min_length": 100,   
        },
        
        "prompt": """
        ä½ æ˜¯ä¸€ä½**ä¸¥è°¨ä¸”æ•é”çš„åŒ—äº¬å†å²èµ„æ–™æ•´ç†ä¸“å‘˜**ã€‚ä½ çš„ä»»åŠ¡æ˜¯ä»åŸå§‹æ–‡æ¡£ä¸­æŒ–æ˜å¹¶æ•´ç†å‡ºæœ‰ä»·å€¼çš„ã€ç‹¬ç«‹çš„**"å¯¼è§ˆçŸ¥è¯†ç‚¹ç´ æ"**ã€‚

ğŸ¯ æ ¸å¿ƒç›®æ ‡ï¼š
æˆ‘ä»¬è¦æ„å»ºä¸€ä¸ª"åŒ—äº¬èƒ¡åŒçŸ¥è¯†å›¾è°±"ã€‚è¯·å°†è¿ç»­çš„æ–‡æœ¬æ‹†è§£ä¸ºä¸€ä¸ªä¸ª**ç‹¬ç«‹ã€å®Œæ•´**çš„çŸ¥è¯†æ¡ç›®ï¼Œä¾›åç»­ç¼–å†™å¯¼è§ˆè¯ä½¿ç”¨ã€‚

âœ… æå–æ ‡å‡†ï¼ˆæ»¡è¶³ä»¥ä¸‹ä»»ä¸€ç»´åº¦å³å¯æå–ï¼‰ï¼š

1. **è€å­—å·ä¸äººç‰©**ï¼šåº—é“ºçš„ç”±æ¥ï¼ˆå¦‚å¾·å…´æ°¸é‡‘ç®”é“ºï¼‰ã€åˆ›å§‹äººçš„æ•…äº‹ã€åäººåœ¨èƒ¡åŒçš„è½¶äº‹ã€‚
2. **é£ä¿—ä¸å·¥è‰º**ï¼šç‰¹å®šåœ°ç‚¹çš„ç‰¹æ®Šè¡Œä¸šï¼ˆå¦‚é”¤é‡‘ç®”ï¼‰ã€ç”Ÿæ´»ä¹ æƒ¯ã€å«å–å£°ç­‰ã€‚
3. **åœ°åç”±æ¥**ï¼šèƒ¡åŒæˆ–åœ°ååå­—èƒŒåçš„å†å²æ¸Šæºã€‚
4. **æ°‘é—´ä¼ è¯´**ï¼šä¼ ç»Ÿçš„çµå¼‚ã€ç¥è¯æˆ–æ°‘é—´æ•…äº‹ã€‚

âš¡ï¸ æ ¸å¿ƒå¤„ç†è§„åˆ™ï¼šå…³äº"åˆ‡åˆ†"ã€"åˆå¹¶"ä¸"ç­›é€‰"
è¯·ä¸¥æ ¼éµå¾ªä»¥ä¸‹é€»è¾‘æ¥å¤„ç†æ–‡æœ¬ï¼š

1. **åŒåœ°ä¸åŒäº‹ -> å¿…é¡»æ‹†åˆ† (Split)**
   - å¦‚æœæ–‡ä¸­é’ˆå¯¹åŒä¸€ä¸ªåœ°ç‚¹ï¼ˆå¦‚"å‰é—¨"ï¼‰ï¼Œè®²äº†ä¸¤ä¸ª**æ—¶é—´ä¸åŒã€ä¸»é¢˜æ— å…³**çš„æ•…äº‹ï¼Œå¿…é¡»æ‹†åˆ†ä¸º**ä¸¤æ¡ç‹¬ç«‹çš„æ•°æ®**ã€‚
   - *ç¤ºä¾‹*ï¼šå¦‚æœä¸€æ®µè¯å…ˆè®²äº†"å‰é—¨ç«è½¦ç«™çš„å»ºç«‹"ï¼Œç´§æ¥ç€è®²äº†"å‰é—¨å¤§ç¢—èŒ¶çš„å«å–å£°"ã€‚è¿™æ˜¯ä¸¤ä¸ªç‹¬ç«‹çš„å¯¼è§ˆç‚¹ï¼Œè¯·ç”Ÿæˆä¸¤ä¸ªå¯¹è±¡ã€‚

2. **åŒåœ°åŒä¸€äº‹ -> å¿…é¡»åˆå¹¶ (Merge)**
   - å¦‚æœå¤šå¥è¯éƒ½åœ¨æè¿°åŒä¸€ä¸ªåº—é“ºçš„å†å²ã€åŒä¸€ä¸ªäººçš„ç”Ÿå¹³æˆ–åŒä¸€ä¸ªäº‹ä»¶çš„èµ·å› ç»è¿‡ç»“æœï¼Œè¯·å°†å®ƒä»¬**åˆå¹¶**åœ¨ä¸€æ¡æ•°æ®çš„ summary ä¸­ï¼Œ**ä¸¥ç¦**æ‹†åˆ†æˆç¢å¥å­ã€‚
   - *ç¤ºä¾‹*ï¼š"å¼ æ°æ˜¯è‹å·äºº" å’Œ "ä»–åœ¨å‰é—¨å¼€äº†é‡‘ç®”é“º" å¿…é¡»åˆå¹¶ä¸ºä¸€æ¡å…³äº"å¼ æ°åˆ›ä¸šå²"çš„è®°å½•ã€‚

3. **å»ä¼ªå­˜çœŸ -> è¿‡æ»¤é€šç”¨è§£é‡Š**
   - è¿‡æ»¤æ‰çº¯ç²¹çš„é€šç”¨è§£é‡Šï¼ˆå¦‚"é‡‘ç®”æ˜¯ä»€ä¹ˆ"ã€"å››åˆé™¢çš„æ„é€ "ï¼‰ï¼Œåªä¿ç•™ä¸**å…·ä½“åœ°ç‚¹ã€äººç‰©ã€å†å²äº‹ä»¶**å¼ºç›¸å…³çš„å†…å®¹ã€‚

ğŸ“ å­—æ®µæå–è¦æ±‚ï¼š

1. **story_name (æ ‡é¢˜)**: 
   - ç®€æ˜æ‰¼è¦åœ°æ¦‚æ‹¬è¿™ä¸ªçŸ¥è¯†ç‚¹ã€‚
   - **å·®å¼‚åŒ–åŸåˆ™**ï¼šå¦‚æœåŒä¸€åœ°ç‚¹æå–å¤šæ¡ï¼Œæ ‡é¢˜å¿…é¡»èƒ½åŒºåˆ†å†…å®¹ï¼ˆå¦‚"å‰é—¨çš„å†å²å˜è¿" vs "å‰é—¨çš„è€å­—å·ä¼ è¯´"ï¼‰ã€‚

2. **location (åœ°ç‚¹)**: 
   - å¿…å¡«ã€‚äº‹ä»¶å‘ç”Ÿçš„æ ¸å¿ƒåœ°ç‚¹ï¼ˆèƒ¡åŒåã€åº—é“ºåæˆ–åœ°æ ‡ï¼‰ã€‚

3. **summary (ç®¡ç†å‘˜æ‘˜è¦)**: 
   - **æ³¨æ„ï¼šè¿™ä¸æ˜¯å¯¼æ¸¸è¯ï¼ä¸è¦ä½¿ç”¨"å„ä½æ¸¸å®¢"ç­‰å£è¯­ã€‚**
   - è¯·ç”¨**å®¢è§‚ã€ç²¾ç‚¼**çš„è¯´æ˜æ–‡å£å»ï¼Œæ€»ç»“è¿™æ¡æ•°æ®åŒ…å«çš„å…³é”®ä¿¡æ¯ç‚¹ï¼ˆæ—¶é—´ã€äººç‰©ã€èµ·å› ã€ç»“æœï¼‰ã€‚
   - **ç‹¬ç«‹æ€§**ï¼šæ¯ä¸€æ¡æ‘˜è¦å¿…é¡»èƒ½**ç‹¬ç«‹é˜…è¯»**ï¼Œä¸éœ€è¦ä¾èµ–ä¸Šä¸€æ¡æ•°æ®å°±èƒ½çœ‹æ‡‚ã€‚
   - å­—æ•°ï¼š100-300å­—ï¼Œç¡®ä¿ä¿¡æ¯å®Œæ•´ã€‚

4. **text_content (æ ¸å¿ƒåŸæ–‡æˆªå–)**:
   - è¯·æ‘˜å½•æ–‡ä¸­æ”¯æ’‘ä¸Šè¿°æ‘˜è¦çš„**åŸå§‹æ®µè½**ä½œä¸ºè¯æ®ã€‚
   - **ç²¾å‡†æ‘˜å½•**ï¼šå¦‚æœä¸€æ®µåŸæ–‡åŒæ—¶åŒ…å«ä¸¤ä¸ªæ•…äº‹ï¼Œè¯·åœ¨æå–ç¬¬ä¸€æ¡æ•°æ®æ—¶åªæ‘˜å½•å‰åŠæ®µï¼Œæå–ç¬¬äºŒæ¡æ•°æ®æ—¶æ‘˜å½•ååŠæ®µï¼›å¦‚æœåˆ†ä¸å¼€ï¼Œå¯ä»¥é‡å¤å¼•ç”¨ã€‚

5. **is_legend**: 
   - True: æ°‘é—´ä¼ è¯´ã€ç¥è¯ï¼ˆå¦‚"é“¸é’Ÿå¨˜å¨˜"ï¼‰ã€‚
   - False: å²å®ã€è€ƒè¯ã€è€å­—å·è®°è½½ï¼ˆå¦‚"å¾·å…´æ°¸é‡‘ç®”é“º"ï¼‰ã€‚

6. **valid**: 
   - True: å†…å®¹åŒ…å«å…·ä½“çš„åœ°ç‚¹ã€äººç‰©å’Œå®Œæ•´çš„çŸ¥è¯†ç‚¹ã€‚
   - False: å†…å®¹ç©ºæ´ã€æ— å…·ä½“åœ°ç‚¹æˆ–çº¯é€šç”¨çŸ¥è¯†ã€‚

è¯·æå–å‡ºæ‰€æœ‰æœ‰ä»·å€¼çš„ã€ç‹¬ç«‹çš„çŸ¥è¯†ç‚¹ç´ æï¼Œä¸è¦é—æ¼ã€‚

"""
    },
    
    # ========== å»ºç­‘æŠ€æœ¯æ–‡æ¡£ ==========
    "arch": {
        "description": "å»ºç­‘æŠ€æœ¯æ–‡æ¡£",
        "schema": ArchitectureDoc,
        
        # åˆ‡åˆ†é…ç½®ï¼ˆæŒ‰å­—æ•°åˆ‡åˆ†ï¼‰
        "chunking": {
            "mode": "sentence",  # æŒ‰å­—æ•°åˆ‡åˆ†ï¼ˆä¿ç•™ mode ä»¥ä¾¿åç»­æ‰©å±•ï¼‰
            "chunk_size": 1000,   # æ¯å—æœ€å¤§å­—ç¬¦æ•°ï¼ˆå»ºç­‘æ–‡æ¡£ä¿¡æ¯å¯†åº¦é«˜ï¼Œå—ç¨å°ï¼‰
            "overlap": 80,       # å—ä¹‹é—´é‡å å­—ç¬¦æ•°
            "min_length": 200,   # æœ€å°å—é•¿åº¦ï¼ˆä½äºæ­¤å€¼ç›´æ¥ä¸¢å¼ƒï¼‰
        },
        
        "prompt": """ä½ æ˜¯ä¸€ä½å»ºç­‘å†å²ä¸“å®¶ã€‚è¯·åˆ†æè¿™ç¯‡æ–‡æ¡£ï¼Œæå–åŒ—äº¬å¤å»ºç­‘çš„è¯¦ç»†ä¿¡æ¯ã€‚

âš ï¸ ä¸¥æ ¼ç­›é€‰è§„åˆ™ï¼ˆä»…æå–ä»¥ä¸‹ç±»å‹ï¼‰ï¼š
- âœ… å…è®¸çš„å»ºç­‘ç±»å‹ï¼šå¤å»ºç­‘ã€é—å€ã€æ•…å±…ã€å¯ºåº™ã€å›­æ—ã€ä¼ ç»Ÿæ°‘å±…ã€å†å²å»ºç­‘
- âŒ æ’é™¤çš„å†…å®¹ï¼šç°ä»£å»ºç­‘ï¼ˆ1949å¹´åï¼‰ã€çº¯è¡Œæ”¿å…¬æ–‡ã€æ—…æ¸¸å¹¿å‘Šã€æ–½å·¥æŠ¥å‘Šã€æ— å…³å†…å®¹
- **location å­—æ®µå¿…å¡«**ï¼šå¦‚æœæ–‡æ¡£ä¸­æ²¡æœ‰æ˜ç¡®çš„å»ºç­‘åç§°æˆ–åœ°ç‚¹ï¼Œè¯·ä¸è¦æå–ã€‚

åˆ†æç»´åº¦ï¼š
1. **å»ºç­‘ç›¸å…³æ€§**: å¿…é¡»æ˜¯æ˜ç¡®çš„åŒ—äº¬å¤å»ºç­‘æˆ–å†å²å»ºç­‘
2. **ä¸“ä¸šæ€§**: åŒ…å«å»ºç­‘ç»“æ„ã€é£æ ¼ã€å†å²èƒŒæ™¯ç­‰ä¸“ä¸šä¿¡æ¯
3. **è¯¦å®åº¦**: ä¿¡æ¯è¯¦ç»†ã€å‡†ç¡®ã€æœ‰å‚è€ƒä»·å€¼
4. **æ—¶ä»£æ€§**: é‡ç‚¹å…³æ³¨æ¸…ä»£åŠä»¥å‰çš„å¤å»ºç­‘ï¼Œæ°‘å›½å»ºç­‘å¯é…Œæƒ…æ”¶å½•

æå–å­—æ®µï¼š
1. **å»ºç­‘åç§° (location)**: å»ºç­‘çš„æ­£å¼åç§°ï¼ˆå¿…å¡«ï¼Œå¦‚"å¤ªå’Œæ®¿"ã€"å¤©å›ç¥ˆå¹´æ®¿"ï¼‰
2. **å»ºç­‘ç±»å‹ (category)**: ä»ä»¥ä¸‹é€‰é¡¹é€‰æ‹©
   - å®«æ®¿ã€å¯ºåº™ã€å›­æ—ã€æ•…å±…ã€æ°‘å±…ã€åŸå¢™ã€ç‰Œæ¥¼ã€æ¡¥æ¢ã€å…¶ä»–å¤å»ºç­‘
3. **é¡µç  (page_number)**: å½“å‰å†…å®¹æ‰€åœ¨é¡µç ï¼ˆä» metadata ä¸­æå–ï¼‰
4. **æŠ€æœ¯è§„æ ¼ (technical_specs)**: å»ºç­‘çš„å°ºå¯¸ã€ææ–™ã€ç»“æ„ç‰¹ç‚¹ã€å»ºé€ å¹´ä»£ç­‰ï¼ˆå°½å¯èƒ½è¯¦ç»†ï¼‰
5. **å†…å®¹æ‘˜è¦ (summary)**: ç”¨2-3å¥è¯æ¦‚æ‹¬è¯¥å»ºç­‘çš„å†å²ã€ç‰¹è‰²å’Œä»·å€¼
6. **æœ‰æ•ˆæ€§ (valid)**: æ˜¯å¦å€¼å¾—æ”¶å½•
   - True: ç¬¦åˆä¸Šè¿°å…è®¸ç±»å‹ + æœ‰ä¸“ä¸šä¿¡æ¯ + æœ‰æ–‡åŒ–ä»·å€¼
   - False: ç°ä»£å»ºç­‘ã€æ— å…³å†…å®¹ã€ä¿¡æ¯è¿‡äºç®€ç•¥

æ³¨æ„ï¼š
- è¯·ä¸¥æ ¼æŒ‰ç…§å…è®¸çš„å»ºç­‘ç±»å‹ç­›é€‰ï¼Œç°ä»£å»ºç­‘ä¸€å¾‹æ ‡è®°ä¸º valid=False
- technical_specs è¯·å°½å¯èƒ½ä»æ–‡æ¡£ä¸­æå–è¯¦ç»†æ•°æ®ï¼ˆé«˜åº¦ã€é¢ç§¯ã€æŸ±æ•°ã€å»ºé€ å¹´ä»£ç­‰ï¼‰
- å¦‚æœæ–‡æ¡£æ˜¯çº¯è¡Œæ”¿å…¬æ–‡ã€æ–½å·¥æŠ¥å‘Šï¼Œè¯·æ ‡è®°ä¸º valid=False
""",
    },
}


# ============================================================================
# è¾…åŠ©å‡½æ•°
# ============================================================================

def get_domain_config(domain_type: str) -> Optional[Dict[str, Any]]:
    """
    è·å–æŒ‡å®šä¸šåŠ¡ç±»å‹çš„é…ç½®
    
    Args:
        domain_type: ä¸šåŠ¡ç±»å‹ (xhs, legend, arch)
    
    Returns:
        é…ç½®å­—å…¸ï¼Œå¦‚æœä¸å­˜åœ¨è¿”å› None
    """
    return DOMAIN_CONFIG.get(domain_type)


def get_schema(domain_type: str) -> Optional[Type[BaseModel]]:
    """
    è·å–æŒ‡å®šä¸šåŠ¡ç±»å‹çš„æ•°æ®æ¨¡å‹
    
    Args:
        domain_type: ä¸šåŠ¡ç±»å‹
    
    Returns:
        Pydantic Schema ç±»
    """
    config = get_domain_config(domain_type)
    return config["schema"] if config else None


def get_prompt(domain_type: str) -> Optional[str]:
    """
    è·å–æŒ‡å®šä¸šåŠ¡ç±»å‹çš„ Prompt
    
    Args:
        domain_type: ä¸šåŠ¡ç±»å‹
    
    Returns:
        Prompt æ–‡æœ¬
    """
    config = get_domain_config(domain_type)
    return config["prompt"] if config else None


def get_chunking_type(domain_type: str) -> str:
    """
    è·å–æŒ‡å®šä¸šåŠ¡ç±»å‹çš„åˆ†å—ç­–ç•¥æ¨¡å¼
    
    Args:
        domain_type: ä¸šåŠ¡ç±»å‹
    
    Returns:
        åˆ†å—æ¨¡å¼ (none, markdown, sentence)
    """
    config = get_domain_config(domain_type)
    if not config:
        return "sentence"  # é»˜è®¤æŒ‰å¥å­åˆ†å—
    
    chunking = config.get("chunking", {})
    return chunking.get("mode", "sentence")


def get_chunking_config(domain_type: str) -> Dict[str, Any]:
    """
    è·å–æŒ‡å®šä¸šåŠ¡ç±»å‹çš„å®Œæ•´åˆ‡åˆ†é…ç½®
    
    Args:
        domain_type: ä¸šåŠ¡ç±»å‹
    
    Returns:
        åˆ‡åˆ†é…ç½®å­—å…¸ï¼ŒåŒ…å« mode, chunk_size, overlap, min_length ç­‰
    """
    config = get_domain_config(domain_type)
    if not config:
        return {
            "mode": "sentence",
            "chunk_size": 512,
            "overlap": 64,
            "min_length": 0,
        }
    
    return config.get("chunking", {
        "mode": "sentence",
        "chunk_size": 512,
        "overlap": 64,
        "min_length": 0,
    })


def list_domain_types() -> Dict[str, str]:
    """
    åˆ—å‡ºæ‰€æœ‰ä¸šåŠ¡ç±»å‹åŠå…¶æè¿°
    
    Returns:
        {domain_type: description}
    """
    return {
        key: config["description"]
        for key, config in DOMAIN_CONFIG.items()
    }


def validate_domain_config(domain_type: str) -> bool:
    """
    éªŒè¯æŒ‡å®šä¸šåŠ¡ç±»å‹çš„é…ç½®æ˜¯å¦å®Œæ•´
    
    Args:
        domain_type: ä¸šåŠ¡ç±»å‹
    
    Returns:
        True if é…ç½®å®Œæ•´ï¼ŒFalse otherwise
    """
    config = get_domain_config(domain_type)
    if not config:
        return False
    
    required_keys = ["description", "schema", "chunking", "prompt"]
    return all(key in config for key in required_keys)


# ============================================================================
# ä¸»å‡½æ•°ï¼šå±•ç¤ºæ‰€æœ‰é…ç½®
# ============================================================================

if __name__ == "__main__":
    print("=" * 80)
    print("ä¸šåŠ¡é¢†åŸŸé…ç½®æ€»è§ˆ")
    print("=" * 80)
    
    for domain_type, config in DOMAIN_CONFIG.items():
        print(f"\nã€{domain_type.upper()}ã€‘- {config['description']}")
        print(f"  Schema: {config['schema'].__name__}")
        print(f"  Chunking: {config['chunking']}")
        print(f"  Prompt é•¿åº¦: {len(config['prompt'])} å­—ç¬¦")
        print(f"  éªŒè¯: {'âœ“ æœ‰æ•ˆ' if validate_domain_config(domain_type) else 'âœ— æ— æ•ˆ'}")
    
    print("\n" + "=" * 80)
    print("æ‰€æœ‰ä¸šåŠ¡ç±»å‹:")
    print("=" * 80)
    for key, desc in list_domain_types().items():
        print(f"  - {key}: {desc}")
